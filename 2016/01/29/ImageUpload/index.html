<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      图片增加、删除 | YimSam-Tam 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="YimSam-Tam">
    
    

    <meta name="description" content="利用RecyclerView实现图片新增、删除删除**  新增">
<meta property="og:type" content="article">
<meta property="og:title" content="图片增加、删除 | YimSam-Tam">
<meta property="og:url" content="YimSamTam.github.io/2016/01/29/ImageUpload/index.html">
<meta property="og:site_name" content="YimSam-Tam">
<meta property="og:description" content="利用RecyclerView实现图片新增、删除删除**  新增">
<meta property="og:image" content="http://imglf.nosdn.127.net/img/U05xRllGZk4zNVBPVkk0UDFXOXdnRElIK2RMZVRrcVVUYkVUcnozM09VYXVlTXhHMWNLay9BPT0.jpg?imageView&thumbnail=300x0&quality=96&stripmeta=0&type=jpg">
<meta property="og:image" content="http://imglf2.nosdn.127.net/img/U05xRllGZk4zNVBPVkk0UDFXOXdnUExxVlY3cTlvZW1PT2h2U1lJWW9uK0RPdHc0dlFWR2lBPT0.jpg?imageView&thumbnail=300x0&quality=96&stripmeta=0&type=jpg">
<meta property="og:updated_time" content="2016-05-03T09:16:23.997Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="图片增加、删除 | YimSam-Tam">
<meta name="twitter:description" content="利用RecyclerView实现图片新增、删除删除**  新增">
<meta name="twitter:image" content="http://imglf.nosdn.127.net/img/U05xRllGZk4zNVBPVkk0UDFXOXdnRElIK2RMZVRrcVVUYkVUcnozM09VYXVlTXhHMWNLay9BPT0.jpg?imageView&thumbnail=300x0&quality=96&stripmeta=0&type=jpg">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">YimSam-Tam</a></h1>
        <hr class="panel-cover__divider" />

        
        <p class="panel-cover__description">
          程序猿
        </p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">首页</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">关于</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">归档</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">图片增加、删除</h1>

    

    <div class="post-meta">
      <time datetime="2016-01-29" class="post-meta__date date">2016-01-29</time> 

      <span class="post-meta__tags tags">

          

          
             &#8226; 标签:
            <font class="tags">
              <a class="tags-link" href="/tags/ImageUpload/">ImageUpload</a>, <a class="tags-link" href="/tags/RecyclerView/">RecyclerView</a>
            </font>
          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <h2 id="利用RecyclerView实现图片新增、删除"><a href="#利用RecyclerView实现图片新增、删除" class="headerlink" title="利用RecyclerView实现图片新增、删除"></a><font color="red">利用RecyclerView实现图片新增、删除</font></h2><h3 id="删除-新增"><a href="#删除-新增" class="headerlink" title="删除**  新增"></a>删除<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>**</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>  新增</h3><p><img src="http://imglf.nosdn.127.net/img/U05xRllGZk4zNVBPVkk0UDFXOXdnRElIK2RMZVRrcVVUYkVUcnozM09VYXVlTXhHMWNLay9BPT0.jpg?imageView&amp;thumbnail=300x0&amp;quality=96&amp;stripmeta=0&amp;type=jpg" alt=""><br><img src="http://imglf2.nosdn.127.net/img/U05xRllGZk4zNVBPVkk0UDFXOXdnUExxVlY3cTlvZW1PT2h2U1lJWW9uK0RPdHc0dlFWR2lBPT0.jpg?imageView&amp;thumbnail=300x0&amp;quality=96&amp;stripmeta=0&amp;type=jpg" alt=""></p>
<a id="more"></a>
<ul>
<li><p>思路：</p>
<ol>
<li>由于新增跟删除只是一个添加按钮跟CheckBox的区别，所以我们可以将两种情况分别用Adapter表示。</li>
<li>先定义删除的Adapter ， 重写getItemViewType方法，返回该Adapter的标识。</li>
<li>定义新增的Adapter，继承删除的Adapter，其布局只有一个ImageView（添加按钮）。</li>
<li>然后通过是否编辑模式，决定设置那种Adapter。</li>
</ol>
</li>
</ul>
<pre><code>下面给出部分代码


  public class BaseHolder extends RecyclerView.ViewHolder {
  public View rootView;

      public BaseHolder(View itemView) {
          super(itemView);
          rootView = itemView;
      }
  }


  class PicAdapter extends RecyclerView.Adapter&lt;BaseHolder&gt; {
  private final int TYPE_ITEM = 0x00; //定义标识，标识是普通Item
  @Override
  public BaseHolder onCreateViewHolder(ViewGroup parent, int viewType) {
      View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.pic_album_item_view, parent, false);
      return new PicHolder(view);
  }

  @Override
  public void onBindViewHolder(final BaseHolder holder, int position) {
      holder.rootView.setOnClickListener(new View.OnClickListener() {
          @Override
          public void onClick(View v) {
              //这里实现的是点击Item的处理逻辑
              Functions.toast(getApplicationContext(), holder.getLayoutPosition() + &quot;&quot;);
          }
      });
      String image = images.get(position).getPicurl();
      PicHolder picHolder = (PicHolder) holder;
      picHolder.ivPicture.setImageResource(Functions.getResourceIdByString(image));
      if (isEditMode) {
          picHolder.cbSelectImg.setVisibility(View.VISIBLE);
      } else {
          picHolder.cbSelectImg.setVisibility(View.GONE);
      }
  }

  @Override
  public int getItemCount() {
      return images.size(); //返回集合size
  }

      @Override
      public int getItemViewType(int position) {
          return TYPE_ITEM; //返回普通Item的类型
      }

      class PicHolder extends BaseHolder {
          private ImageView ivPicture;
          private View view;
          private CheckBox cbSelectImg;

          public PicHolder(View itemView) {
              super(itemView);
              view = itemView;
              ivPicture = (ImageView) view.findViewById(R.id.ivPicture);
              cbSelectImg = (CheckBox) view.findViewById(R.id.cbSelectImg);
          }
      }
    }


  class AddPicAdapter extends PicAdapter {
  public final static int TYPE_ADD = 0x11; //定义添加Item的标识

  @Override
  public BaseHolder onCreateViewHolder(final ViewGroup parent, int viewType) {
      BaseHolder holder;
      //通过viewType判断加载那种布局
      if (viewType == TYPE_ADD) {
          View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.pic_album_add_item_view, parent, false);
          view.setOnClickListener(new View.OnClickListener() {

              //点击添加按钮的处理逻辑
              @Override
              public void onClick(View v) {
                  MovieMsgInfo info = new MovieMsgInfo();
                  Random random = new Random();
                  int result = random.nextInt(11) + 1;
                  info.setPicurl(PREIFX_DRAWABLE + result);
                  images.add(info);
                  mAdapter.notifyDataSetChanged();
              }
          });
          holder = new AddPicHolder(view);
          return holder;
      } else {
          return super.onCreateViewHolder(parent, viewType);
      }
  }

    @Override
    public void onBindViewHolder(BaseHolder holder, int position) {
        //通过判断是否点击最后一个Item
        if (position == getItemCount() - 1) {
            holder.rootView.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View v) {
                    //点击最后添加按钮的处理逻辑
                }
            });

        } else {
            super.onBindViewHolder(holder, position);
        }
    }

    @Override
    public int getItemViewType(int position) {
        //根据position判断加载类型
        if (position == getItemCount() - 1) {
            return TYPE_ADD;
        }
        return super.getItemViewType(position);
    }


    @Override
    public int getItemCount() {
        //重中之重，返回Item数量为父类总数+1（+1是添加按钮）
        return super.getItemCount() + 1;
    }

    public class AddPicHolder extends BaseHolder {

        private ImageView ivPicture;

        public AddPicHolder(View itemView) {
            super(itemView);
            ivPicture = (ImageView) itemView.findViewById(R.id.ivPicture);
        }
    }

    }
</code></pre><h2 id="HashSet控制集合选中以及取消"><a href="#HashSet控制集合选中以及取消" class="headerlink" title="HashSet控制集合选中以及取消"></a><font red="red">HashSet控制集合选中以及取消</font></h2><ul>
<li>选中：点击的时候，将id加入到集合中</li>
<li>取消选择：判断是否包含该元素，是则删除，没有则添加。</li>
</ul>
<pre><code>onlick(){

  if(set.contain(user.getID())){
      set.remove(user.getID());
  }else{
      set.add(user.getId());
  }

}
</code></pre>
  </section>

  
  
</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | 由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno">Huno</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
