<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />

    <!--Description-->
    
        <meta name="description" content="Build a better app.">
    

    <!--Author-->
    
        <meta name="author" content="TanJunDang">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="ViewPager笔记"/>
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="TanJunDang"/>

    <!--Page Cover-->
    
        <meta property="og:image" content="undefined"/>
    

    <!-- Title -->
    
    <title>ViewPager笔记 - TanJunDang</title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/main.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


    <!--Favicon-->
    

</head>

<body>

<!-- Menu -->
<!-- Navigation -->
<header>
    <div class="logo">
        <a href="/">TanJunDang</a>
    </div><!-- end logo -->

    <div id="menu_icon"></div>
    <nav>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives">Archives</a>
            </li>
            
        </ul>
    </nav><!-- end navigation menu -->

    <div class="footer clearfix">
        <ul class="social clearfix">
            
            
                <li><a href="https://www.facebook.com/" class="fb" target="_blank" data-title="Facebook"></a></li>
            
            
                <li><a href="https://www.behance.net/" class="behance" target="_blank" data-title="Behance"></a></li>
            
            
                <li><a href="https://plus.google.com/+Pixelhint/posts" class="google" target="_blank" data-title="Google+"></a></li>
            
            
                <li><a href="https://dribbble.com/pixelhint" class="dribble" target="_blank" data-title="Dribble"></a></li>
            
            
            
            
        </ul><!-- end social -->

        <div class="rights">
            <p>Copyright © 2014 magnetic.</p>
            <p>Template by <a href="http://pixelhint.com/magnetic-free-html5-responsive-photography-website-template/">Pixelhint.com</a></p>
            <p>Hexo Theme by <a href="http://www.codeblocq.com/">Jonathan K.</a></p>
        </div><!-- end rights -->
    </div ><!-- end footer -->
</header><!-- end header -->


<!-- Main Content -->
<section class="main clearfix">

    <section class="top" style="background: url('http://placehold.it/1300x500');">
        <div class="wrapper content_header clearfix">
            

<div class="work_nav">

    <ul class="btn clearfix">
        
        <li><a href="/2016/10/09/Android-Permission/" class="previous" data-title="Android6.0权限"></a></li>
        
        <li><a href="/" class="grid" data-title="Portfolio"></a></li>
        
        <li><a href="/2016/09/14/ToolBar/" class="next" data-title="Toolbar笔记"></a></li>
        
    </ul>

</div><!-- end work_nav -->
            <h1 class="title">ViewPager笔记</h1>
        </div>
    </section><!-- end top -->

    <section class="wrapper">
        <div class="content">

            <!-- Gallery -->
            

            <!-- Content -->
            <h1 id="TabLayout、ViewPager基础知识"><a href="#TabLayout、ViewPager基础知识" class="headerlink" title="TabLayout、ViewPager基础知识"></a>TabLayout、ViewPager基础知识</h1><blockquote>
<p>ViewPager的理解<br>1.ViewPager是用于页面滑动的View。<br>2.ViewPager之所以滑动流畅是因为有预加载机制,既显示当前页面时,自动初始化下一页的View.<br>3.ViewPager常与Fragment、FragmentPagerAdaper结合使用。</p>
</blockquote>
<a id="more"></a>
<blockquote>
<p>TabLayout理解<br>1.TabLayout通常与ViewPager联合使用。<br>2.TabLayout主要用于设置tab标题、关联ViewPager、设置自定义Tab、设置tab选中监听器。<br>3.ViewPager主要用于创建FragmentPagerAdapter、设置Adapter。（跟ListView用法类似）</p>
<p>使用<br>1.在XML里设置TabLayout跟ViewPager。通常纯文本的Tab在顶部，包含Icon的Tab在底部。<br>2.创建Tab标题数组以及Fragment的List集合。<br>3.创建FragmentPagerAdapter，重写getCount、getItem、getPageTitle等方法。<br>4.ViewPager创建Adapter并调用setAdapter方法。<br>5.TabLayout使用setupWithViewPager进行关联。(如果是自定义Tab，还需要调用setTabsFromPagerAdapter)</p>
</blockquote>
<h1 id="示例-普通的TabLayout"><a href="#示例-普通的TabLayout" class="headerlink" title="示例 - 普通的TabLayout"></a>示例 - 普通的TabLayout</h1><p><img src="http://imglf2.nosdn.127.net/img/ZFRpZXBrMUVQR0FCTmEzNDk0VnBCODdsVyszZHFJQzBweGNMb3B6ZjZJSjAxLzUrU0ZEWEpRPT0.gif" alt=""></p>
<blockquote>
<p>Tab是纯文本的情况<br>不需要重写setOnTabSelectedListener方法</p>
</blockquote>
<h2 id="XML代码"><a href="#XML代码" class="headerlink" title="XML代码"></a>XML代码</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span><br><span class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/activity_view_pager"</span></span><br><span class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span><br><span class="line">    <span class="attr">tools:context</span>=<span class="string">"io.tanjundang.study.knowledge.viewpager.CustomTabActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.design.widget.TabLayout</span></span><br><span class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/tabLayout"</span></span><br><span class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span><br><span class="line">        <span class="attr">android:layout_alignParentBottom</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">android.support.design.widget.TabLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.v4.view.ViewPager</span></span><br><span class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/viewPager"</span></span><br><span class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span><br><span class="line">        <span class="attr">android:layout_above</span>=<span class="string">"@+id/tabLayout"</span>&gt;</span><span class="tag">&lt;/<span class="name">android.support.v4.view.ViewPager</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Activity中的代码"><a href="#Activity中的代码" class="headerlink" title="Activity中的代码"></a>Activity中的代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleTabActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TabLayout tabLayout;</span><br><span class="line">    <span class="keyword">private</span> ViewPager viewPager;</span><br><span class="line">    <span class="keyword">private</span> String[] tabs = <span class="keyword">new</span> String[]&#123;<span class="string">"Tab1"</span>, <span class="string">"Tab2"</span>, <span class="string">"Tab3"</span>, <span class="string">"Tab4"</span>&#125;;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Fragment&gt; fragments = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> PageOneFragment pageOneFragment;</span><br><span class="line">    <span class="keyword">private</span> PageTwoFragment pageTwoFragment;</span><br><span class="line">    <span class="keyword">private</span> PageThreeFragment pageThreeFragment;</span><br><span class="line">    <span class="keyword">private</span> CustomFragment customFragment;</span><br><span class="line">    <span class="keyword">private</span> SimpleTabAdapter mAdapter;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_simple_tab);</span><br><span class="line">        initFragment();</span><br><span class="line">        tabLayout = (TabLayout) findViewById(R.id.tabLayout);</span><br><span class="line">        viewPager = (ViewPager) findViewById(R.id.viewPager);</span><br><span class="line">        mAdapter = <span class="keyword">new</span> SimpleTabAdapter(getSupportFragmentManager());</span><br><span class="line">        viewPager.setAdapter(mAdapter);<span class="comment">//设置数据源</span></span><br><span class="line">        tabLayout.setupWithViewPager(viewPager); <span class="comment">//将TabLayout和ViewPager关联。</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//下面的方法根据需求决定是否调用</span></span><br><span class="line">        tabLayout.setTabTextColors(Color.GRAY, Color.BLUE);<span class="comment">//设置选中与通常情况下tab的颜色</span></span><br><span class="line">        tabLayout.setBackgroundResource(R.color.common_text_alpha_white);<span class="comment">//设置TabLayout背景色</span></span><br><span class="line">        tabLayout.setSelectedTabIndicatorColor(Color.RED);<span class="comment">//设置下划线的颜色</span></span><br><span class="line">        tabLayout.setSelectedTabIndicatorHeight(<span class="number">5</span>);<span class="comment">//设置下划线高度</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化Fragment</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initFragment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        fragments.clear();</span><br><span class="line">        <span class="keyword">if</span> (pageOneFragment == <span class="keyword">null</span>) &#123;</span><br><span class="line">            pageOneFragment = PageOneFragment.newInstance();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pageTwoFragment == <span class="keyword">null</span>) &#123;</span><br><span class="line">            pageTwoFragment = PageTwoFragment.newInstance();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pageThreeFragment == <span class="keyword">null</span>) &#123;</span><br><span class="line">            pageThreeFragment = PageThreeFragment.newInstance();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (customFragment == <span class="keyword">null</span>) &#123;</span><br><span class="line">            customFragment = CustomFragment.newInstance();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        fragments.add(pageOneFragment);</span><br><span class="line">        fragments.add(pageTwoFragment);</span><br><span class="line">        fragments.add(pageThreeFragment);</span><br><span class="line">        fragments.add(customFragment);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自定义FragmentPagerAdapter</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">SimpleTabAdapter</span> <span class="keyword">extends</span> <span class="title">FragmentPagerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">SimpleTabAdapter</span><span class="params">(FragmentManager fm)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(fm);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Fragment <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> fragments.get(position);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> tabs.length;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> CharSequence <span class="title">getPageTitle</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> tabs[position];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote>
<p>理解每个View的作用和使用流程即可。</p>
</blockquote>
<h1 id="示例-自定义TabLayout"><a href="#示例-自定义TabLayout" class="headerlink" title="示例 - 自定义TabLayout"></a>示例 - 自定义TabLayout</h1><p><img src="http://imglf.nosdn.127.net/img/ZFRpZXBrMUVQR0FCTmEzNDk0VnBCNkV2OGg2OWwzKzB1TjRKR2t1QVJlNWRuSmg2QUQzY2RnPT0.gif" alt=""></p>
<h2 id="XML中的代码"><a href="#XML中的代码" class="headerlink" title="XML中的代码"></a>XML中的代码</h2><p>同上</p>
<h2 id="Activity中的代码-1"><a href="#Activity中的代码-1" class="headerlink" title="Activity中的代码"></a>Activity中的代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomTabActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TabLayout tabLayout;</span><br><span class="line">    <span class="keyword">private</span> ViewPager viewPager;</span><br><span class="line">    <span class="keyword">private</span> String[] tabs = <span class="keyword">new</span> String[]&#123;<span class="string">"TAB1"</span>, <span class="string">"TAB2"</span>, <span class="string">"TAB3"</span>, <span class="string">"TAB4"</span>&#125;;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] icons = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;R.drawable.ic_menu_camera, R.drawable.ic_menu_send, R.drawable.ic_menu_manage, R.drawable.ic_menu_slideshow&#125;;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Fragment&gt; fragments = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> PageOneFragment pageOneFragment;</span><br><span class="line">    <span class="keyword">private</span> PageTwoFragment pageTwoFragment;</span><br><span class="line">    <span class="keyword">private</span> PageThreeFragment pageThreeFragment;</span><br><span class="line">    <span class="keyword">private</span> CustomFragment customFragment;</span><br><span class="line">    <span class="keyword">private</span> CustomTabAdapter mAdapter;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_custom_tab);</span><br><span class="line">        initFragment();</span><br><span class="line">        tabLayout = (TabLayout) findViewById(R.id.tabLayout);</span><br><span class="line"></span><br><span class="line">        viewPager = (ViewPager) findViewById(R.id.viewPager);</span><br><span class="line">        mAdapter = <span class="keyword">new</span> CustomTabAdapter(getSupportFragmentManager());</span><br><span class="line">        viewPager.setAdapter(mAdapter);</span><br><span class="line"></span><br><span class="line">        tabLayout.setupWithViewPager(viewPager);<span class="comment">//关联起ViewPager</span></span><br><span class="line">        tabLayout.setSelectedTabIndicatorColor(getColor(R.color.transparent));<span class="comment">//设置下划线不显示</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//初始化Tab</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tabLayout.getTabCount(); i++) &#123;</span><br><span class="line">            TabLayout.Tab tab = tabLayout.getTabAt(i);</span><br><span class="line">            tab.setCustomView(mAdapter.getTabView(i));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//默认选中第一个Tab</span></span><br><span class="line">        updateSelected(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * tabLayout选中监听器,用于设置选中Tab的状态</span><br><span class="line">         */</span></span><br><span class="line">        tabLayout.setOnTabSelectedListener(<span class="keyword">new</span> TabLayout.OnTabSelectedListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabSelected</span><span class="params">(TabLayout.Tab tab)</span> </span>&#123;</span><br><span class="line">                TextView tvTitle = (TextView) tab.getCustomView().findViewById(R.id.tvTitle);</span><br><span class="line">                tvTitle.setTextColor(Color.BLUE);</span><br><span class="line">                viewPager.setCurrentItem(tab.getPosition());<span class="comment">//添加该句使点击Tab，可选中页面</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabUnselected</span><span class="params">(TabLayout.Tab tab)</span> </span>&#123;</span><br><span class="line">                TextView tvTitle = (TextView) tab.getCustomView().findViewById(R.id.tvTitle);</span><br><span class="line">                tvTitle.setTextColor(Color.GRAY);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabReselected</span><span class="params">(TabLayout.Tab tab)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 初始化tab默认选中项</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> position</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">updateSelected</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tabLayout.getTabCount(); i++) &#123;</span><br><span class="line">            TabLayout.Tab tab = tabLayout.getTabAt(i);</span><br><span class="line">            <span class="keyword">if</span> (tab != <span class="keyword">null</span>) &#123;</span><br><span class="line">                TextView textView = (TextView) tab.getCustomView().findViewById(R.id.tvTitle);</span><br><span class="line">                textView.setTextColor(i == position ? Color.BLUE : Color.GRAY);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initFragment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        fragments.clear();</span><br><span class="line">        <span class="keyword">if</span> (pageOneFragment == <span class="keyword">null</span>) &#123;</span><br><span class="line">            pageOneFragment = PageOneFragment.newInstance();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pageTwoFragment == <span class="keyword">null</span>) &#123;</span><br><span class="line">            pageTwoFragment = PageTwoFragment.newInstance();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pageThreeFragment == <span class="keyword">null</span>) &#123;</span><br><span class="line">            pageThreeFragment = PageThreeFragment.newInstance();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (customFragment == <span class="keyword">null</span>) &#123;</span><br><span class="line">            customFragment = CustomFragment.newInstance();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        fragments.add(pageOneFragment);</span><br><span class="line">        fragments.add(pageTwoFragment);</span><br><span class="line">        fragments.add(pageThreeFragment);</span><br><span class="line">        fragments.add(customFragment);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">CustomTabAdapter</span> <span class="keyword">extends</span> <span class="title">FragmentPagerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">CustomTabAdapter</span><span class="params">(FragmentManager fm)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(fm);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置了自定义View不能调用tabLayout的setTabGravity方法，否则布局出错</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> View <span class="title">getTabView</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">            View view = LayoutInflater.from(getApplicationContext()).inflate(R.layout.custom_tab, <span class="keyword">null</span>);</span><br><span class="line">            TextView tab = (TextView) view.findViewById(R.id.tvTitle);</span><br><span class="line">            tab.setText(tabs[position]);</span><br><span class="line">            ImageView ivImage = (ImageView) view.findViewById(R.id.ivImage);</span><br><span class="line">            ivImage.setImageResource(icons[position]);</span><br><span class="line">            <span class="keyword">return</span> view;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Fragment <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> fragments.get(position);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> tabs.length;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> CharSequence <span class="title">getPageTitle</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> tabs[position];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="实际开发-ViewPager添加小圆点（广告横幅开发）"><a href="#实际开发-ViewPager添加小圆点（广告横幅开发）" class="headerlink" title="实际开发 - ViewPager添加小圆点（广告横幅开发）"></a>实际开发 - ViewPager添加小圆点（广告横幅开发）</h1><blockquote>
<p>描述<br>小圆点开发类似上述微信ViewPager开发,不同的是小圆点的数量是根据图片的多少来确定,因此需要用到java代码来进行布局。</p>
<p>思路<br>1.在主布局文件里，定义一个LinearLayout并设置id。（用于装小圆点）<br>2.声明一个ImageView数组,用于显示小圆点。<br>3.根据服务器下发的图片数量实例化上述ImageView数组。(new ImageView[pic.size()])<br>4.根据图片数量创建ImageView,设置相关属性,设置背景图,赋值给ImageView数组。<br>5.把该数组加入到上述LinearLayout中即可。(addView)<br>6.重写Viewpager的addOnPageChangeListener里的onPageSelected方法,调用下面的方法,将viewPager与小圆点绑定。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">// mImageViews 是服务器下发图片的长度</span></span><br><span class="line">cycleImgs = <span class="keyword">new</span> ImageView[mImageViews.size()];</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mImageViews.size(); i++) &#123;</span><br><span class="line">         imageView = <span class="keyword">new</span> ImageView(getActivity());</span><br><span class="line">         lp = <span class="keyword">new</span> LinearLayout.LayoutParams(<span class="number">50</span>, <span class="number">50</span>);</span><br><span class="line">         lp.setMargins(<span class="number">15</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0</span>);</span><br><span class="line">         imageView.setLayoutParams(lp);</span><br><span class="line">         cycleImgs[i] = imageView;</span><br><span class="line">         <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="comment">//小圆点初始化,第一张图为选中</span></span><br><span class="line">             cycleImgs[i].setSelected(<span class="keyword">true</span>);</span><br><span class="line">         &#125;</span><br><span class="line">         cycleImgs[i].setBackgroundResource(R.drawable.common_indicator_shape);</span><br><span class="line">         llCycleImages.addView(cycleImgs[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ViewPager预加载"><a href="#ViewPager预加载" class="headerlink" title="ViewPager预加载"></a>ViewPager预加载</h1><blockquote>
<p>理解<br>ViewPager默认机制是当ViewPager加载第一个页面时,会预先加载左右两边的Fragment(调用onCreateView方法)。使其左右滑动时更加流畅。<br>由于Fragment被预加载后，所有View已经FindId。所以当ViewPager跳到该Fragment时，不会再执行onCreateView，也可以直接对各种View进行赋值处理。</p>
<p>需求<br>当用户点击或跳转到该Fragment的时候才进行加载页面，否则不加载。</p>
<p>解决方法<br>在不想预加载的Fragment中重写setUserVisibleHint方法</p>
<p>相关方法<br>setOffscreenPageLimit设置预加载的页面数<br>setUserVisibleHint 一般通过重写的方式来获取boolean值，从而判断当前页面是否可视。</p>
<p>执行流程<br>假设有三个页面(Fragment)A、B、C。进入Activity后,流程如下。<br>1.显示AFragment时，A-setUserVisibleHint(false) -&gt; BsetUserVisibleHint(false) -&gt; A-setUserVisibleHint(true) -&gt; A-onCreateView….B-onCreateView…<br>2.切换到BFragment时,C-setUserVisibleHint(false) -&gt; A-setUserVisibleHint(false) -&gt; B-setUserVisibleHint(true) -&gt; C-onCreateView.<br>综上所述<br>ViewPager切换页面时,ViewPager先执行后一个页面的setUserVisibleHint,然后执行前一个页面的setUserVisibleHint,接着执行当前页面的setUserVisibleHint(true),最后执行后一个页面的onCreateView.</p>
</blockquote>
<h2 id="示例-关闭预加载-设置通用Fragment"><a href="#示例-关闭预加载-设置通用Fragment" class="headerlink" title="示例 - 关闭预加载(设置通用Fragment)"></a>示例 - 关闭预加载(设置通用Fragment)</h2><blockquote>
<p>关键思路：在setUserVisibleHInt 直接初始化数据，有些情况需要先初始化View.ViewPager会预先加载右Tab边一个Fragment的View。</p>
<p>操作流程分三种：<br>1.第一次进入（未初始化View，会执行onCreateView，需要在onCreateView初始化数据）<br>2.点击隔壁Tab（已初始化View，不会执行onCreateView，不需要在onCreateView初始化数据）<br>3.点击远处Tab(未初始化View，会执行onCreateView，需要在onCreateView初始化数据)</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">boolean</span> isNeedInitData = <span class="keyword">true</span>;<span class="comment">//判断是否需要初始化,需要则会执行onCreateView</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserVisibleHint</span><span class="params">(<span class="keyword">boolean</span> isVisibleToUser)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isVisibleToUser) &#123;</span><br><span class="line">        <span class="comment">// 跳转到该页面的时的处理 - 加载数据</span></span><br><span class="line">        <span class="keyword">if</span> (refreshLayout != <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="comment">//                已预先初始化View的情况</span></span><br><span class="line">            refreshLayout.refresh();</span><br><span class="line">            isNeedInitData = <span class="keyword">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//                未预先初始化View的情况</span></span><br><span class="line">            isNeedInitData = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//            页面不可以见时,不加载数据</span></span><br><span class="line">        isNeedInitData = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container,</span><br><span class="line">                         Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    View view = inflater.inflate(R.layout.fragment_order, container, <span class="keyword">false</span>);</span><br><span class="line">    unbinder = ButterKnife.bind(<span class="keyword">this</span>, view);</span><br><span class="line">    initView();</span><br><span class="line"><span class="comment">//        会执行onCreateView，表示未预先初始化View，所以需要加载数据</span></span><br><span class="line"><span class="comment">// 第一次加载、跨越点击Tab都会执行onCreateView</span></span><br><span class="line">    <span class="keyword">if</span> (isNeedInitData) &#123;</span><br><span class="line">        refreshLayout.refresh();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> view;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><blockquote>
<p>知识点<br>1.Tab的类型以及处理<br>当tab是普通文本的时候，可以通过setTabTextColors方法设置选中以及普通情况下tab文本的颜色。<br>当tab是自定义View的时候，需要设置监听器Tab选中的监听器，从而修改选中文本的颜色,需要初始化选中项。<br>2.自定义View的Tab的时候，Adapter需要提供获取自定义Tab的方法。<br>3.为什么tabLayout调用setOnTabSelectedListener方法后，点击Tab无法进行页面跳转？<br>因为setupWithViewPager方法默认封装了setOnTabSelectedListener以及addOnPageChangeListener方法。在其setOnTabSelectedListener的onTabSelected方法中调用了  viewPager.setCurrentItem(tab.getPosition());方法，使Tab可以进行有效跳转。因此我们调用setOnTabSelectedListener方法时，也需要调用setCurrentItem方法。</p>
</blockquote>
<p><a href="http://blog.csdn.net/jav_imba/article/details/47417853" target="_blank" rel="external">viewPager预加载</a></p>


            <!-- Tags -->
            


<div class="tags">
    <a href="/tags/ViewPager预加载/">ViewPager预加载</a>
</div>



            <!-- Comments -->
            <div>
                




            </div>
        </div><!-- end content -->
    </section>
</section><!-- end main -->

<!-- After footer scripts -->

<!-- jQuery -->
<script src="/js/jquery.js"></script>

<!-- Custom Code -->
<script src="/js/main.js"></script>

<!-- Gallery -->
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->


</body>

</html>