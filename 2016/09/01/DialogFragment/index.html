<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />

    <!--Description-->
    
        <meta name="description" content="Build a better app.">
    

    <!--Author-->
    
        <meta name="author" content="TanJunDang">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="DialogFragment笔记"/>
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="TanJunDang"/>

    <!--Page Cover-->
    
        <meta property="og:image" content="undefined"/>
    

    <!-- Title -->
    
    <title>DialogFragment笔记 - TanJunDang</title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/main.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


    <!--Favicon-->
    

</head>

<body>

<!-- Menu -->
<!-- Navigation -->
<header>
    <div class="logo">
        <a href="/">TanJunDang</a>
    </div><!-- end logo -->

    <div id="menu_icon"></div>
    <nav>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives">Archives</a>
            </li>
            
        </ul>
    </nav><!-- end navigation menu -->

    <div class="footer clearfix">
        <ul class="social clearfix">
            
            
                <li><a href="https://www.facebook.com/" class="fb" target="_blank" data-title="Facebook"></a></li>
            
            
                <li><a href="https://www.behance.net/" class="behance" target="_blank" data-title="Behance"></a></li>
            
            
                <li><a href="https://plus.google.com/+Pixelhint/posts" class="google" target="_blank" data-title="Google+"></a></li>
            
            
                <li><a href="https://dribbble.com/pixelhint" class="dribble" target="_blank" data-title="Dribble"></a></li>
            
            
            
            
        </ul><!-- end social -->

        <div class="rights">
            <p>Copyright © 2014 magnetic.</p>
            <p>Template by <a href="http://pixelhint.com/magnetic-free-html5-responsive-photography-website-template/">Pixelhint.com</a></p>
            <p>Hexo Theme by <a href="http://www.codeblocq.com/">Jonathan K.</a></p>
        </div><!-- end rights -->
    </div ><!-- end footer -->
</header><!-- end header -->


<!-- Main Content -->
<section class="main clearfix">

    <section class="top" style="background: url('http://placehold.it/1300x500');">
        <div class="wrapper content_header clearfix">
            

<div class="work_nav">

    <ul class="btn clearfix">
        
        <li><a href="/2016/09/07/Preference/" class="previous" data-title="Preference的使用"></a></li>
        
        <li><a href="/" class="grid" data-title="Portfolio"></a></li>
        
        <li><a href="/2016/08/29/DemoAnalysis/" class="next" data-title="项目源码分析"></a></li>
        
    </ul>

</div><!-- end work_nav -->
            <h1 class="title">DialogFragment笔记</h1>
        </div>
    </section><!-- end top -->

    <section class="wrapper">
        <div class="content">

            <!-- Gallery -->
            

            <!-- Content -->
            <h1 id="DialogFragment笔记"><a href="#DialogFragment笔记" class="headerlink" title="DialogFragment笔记"></a>DialogFragment笔记</h1><blockquote>
<p>理解<br>DialogFragment跟普通的AlertDialog没什么不同，只是添加了一个Fragment而已。<br>使用<br>1.定义DialogFragment。重写onCreateDialog方法或onCraeteView方法<br>2.创建Fragment对象，调用show方法。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义Fragment</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DialogTest</span> <span class="title">extend</span> <span class="title">DialogFragment</span></span>&#123;</span><br><span class="line">  <span class="meta">@NonNull</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Dialog <span class="title">onCreateDialog</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">      Bundle bundle = getArguments();</span><br><span class="line">      title = bundle.getString(TITLE);</span><br><span class="line">      msg = bundle.getString(MSG);</span><br><span class="line">      AlertDialog.Builder builder = <span class="keyword">new</span> AlertDialog.Builder(getActivity());</span><br><span class="line"><span class="comment">//            builder.setIcon(R.mipmap.ic_launcher);</span></span><br><span class="line">      builder.setTitle(title);</span><br><span class="line">      builder.setMessage(msg);</span><br><span class="line">      builder.setPositiveButton(<span class="string">"确定"</span>, positiveListener);</span><br><span class="line">      builder.setNegativeButton(<span class="string">"取消"</span>, negativeListener);</span><br><span class="line">      <span class="keyword">return</span> builder.create();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建对象，调用show方法展示dialog</span></span><br><span class="line">DialogTest dialog = <span class="keyword">new</span> DialogTest();</span><br><span class="line">dialog.show(getSupportFragmentManager,<span class="string">"tag"</span>);</span><br></pre></td></tr></table></figure>
<h1 id="示例-Builder模式的通用Dialog"><a href="#示例-Builder模式的通用Dialog" class="headerlink" title="示例 - Builder模式的通用Dialog"></a>示例 - Builder模式的通用Dialog</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@Author</span>: TanJunDang</span><br><span class="line"> * <span class="doctag">@Date</span>: 2018/3/21</span><br><span class="line"> * <span class="doctag">@Description</span>: 使用Builder模式实现的通用Dialog工具</span><br><span class="line"> * 使用方式</span><br><span class="line"> * 1.创建Builder.</span><br><span class="line"> * 2.调用build</span><br><span class="line"> * 3.调用show</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonDialog</span> <span class="keyword">extends</span> <span class="title">DialogFragment</span> </span>&#123;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="title">CommonDialog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     AppCompatActivity activity;</span><br><span class="line">     Fragment fragment;</span><br><span class="line">     <span class="keyword">private</span> String title;</span><br><span class="line">     <span class="keyword">private</span> String content;</span><br><span class="line">     <span class="keyword">private</span> String confirmText;</span><br><span class="line">     <span class="keyword">private</span> String cancelText;</span><br><span class="line">     <span class="comment">//    cancelable属性不能通过builder来设置，需要创建dialog后才能设置</span></span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">boolean</span> cancelable = <span class="keyword">false</span>;</span><br><span class="line">     <span class="keyword">private</span> DialogInterface.OnClickListener positiveListener;</span><br><span class="line">     <span class="keyword">private</span> DialogInterface.OnClickListener negativeListener;</span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="title">CommonDialog</span><span class="params">(AppCompatActivity activity, String title, String content,</span><br><span class="line">                         String confirmText, String cancelText,</span><br><span class="line">                         <span class="keyword">boolean</span> cancelable,</span><br><span class="line">                         DialogInterface.OnClickListener positiveListener,</span><br><span class="line">                         DialogInterface.OnClickListener negativeListener)</span> </span>&#123;</span><br><span class="line">         <span class="keyword">this</span>.activity = activity;</span><br><span class="line">         <span class="keyword">this</span>.title = title;</span><br><span class="line">         <span class="keyword">this</span>.content = content;</span><br><span class="line">         <span class="keyword">this</span>.confirmText = confirmText;</span><br><span class="line">         <span class="keyword">this</span>.cancelText = cancelText;</span><br><span class="line">         <span class="keyword">this</span>.cancelable = cancelable;</span><br><span class="line">         <span class="keyword">this</span>.positiveListener = positiveListener;</span><br><span class="line">         <span class="keyword">this</span>.negativeListener = negativeListener;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="title">CommonDialog</span><span class="params">(Fragment fragment, String title, String content,</span><br><span class="line">                         String confirmText, String cancelText,</span><br><span class="line">                         <span class="keyword">boolean</span> cancelable,</span><br><span class="line">                         DialogInterface.OnClickListener positiveListener,</span><br><span class="line">                         DialogInterface.OnClickListener negativeListener)</span> </span>&#123;</span><br><span class="line">         <span class="keyword">this</span>.fragment = fragment;</span><br><span class="line">         <span class="keyword">this</span>.title = title;</span><br><span class="line">         <span class="keyword">this</span>.content = content;</span><br><span class="line">         <span class="keyword">this</span>.confirmText = confirmText;</span><br><span class="line">         <span class="keyword">this</span>.cancelText = cancelText;</span><br><span class="line">         <span class="keyword">this</span>.cancelable = cancelable;</span><br><span class="line">         <span class="keyword">this</span>.positiveListener = positiveListener;</span><br><span class="line">         <span class="keyword">this</span>.negativeListener = negativeListener;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isCancelable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> cancelable;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="meta">@NonNull</span></span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">     <span class="function"><span class="keyword">public</span> Dialog <span class="title">onCreateDialog</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">         AlertDialog.Builder builder = <span class="keyword">new</span> AlertDialog.Builder(getContext());</span><br><span class="line">         builder.setTitle(title)</span><br><span class="line">                 .setMessage(content)</span><br><span class="line">                 .setPositiveButton(confirmText, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class="line">                     <span class="meta">@Override</span></span><br><span class="line">                     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</span><br><span class="line">                         <span class="keyword">if</span> (positiveListener != <span class="keyword">null</span>) positiveListener.onClick(dialog, which);</span><br><span class="line">                     &#125;</span><br><span class="line">                 &#125;)</span><br><span class="line">                 .setNegativeButton(cancelText, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class="line">                     <span class="meta">@Override</span></span><br><span class="line">                     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</span><br><span class="line">                         <span class="keyword">if</span> (negativeListener != <span class="keyword">null</span>) negativeListener.onClick(dialog, which);</span><br><span class="line">                     &#125;</span><br><span class="line">                 &#125;);</span><br><span class="line">         AlertDialog dialog = builder.create();</span><br><span class="line">         dialog.setCanceledOnTouchOutside(cancelable);</span><br><span class="line">         <span class="keyword">return</span> dialog;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         show(activity.getSupportFragmentManager(), <span class="string">"CommonDialog"</span>);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line">         <span class="keyword">private</span> String title;</span><br><span class="line">         <span class="keyword">private</span> String content;</span><br><span class="line">         <span class="keyword">private</span> String confirmText = <span class="string">"Confirm"</span>;</span><br><span class="line">         <span class="keyword">private</span> String cancelText = <span class="string">"Cancel"</span>;</span><br><span class="line">         <span class="keyword">private</span> <span class="keyword">boolean</span> isCancelable = <span class="keyword">false</span>;</span><br><span class="line">         <span class="keyword">private</span> DialogInterface.OnClickListener positiveListener;</span><br><span class="line">         <span class="keyword">private</span> DialogInterface.OnClickListener negativeListener;</span><br><span class="line">         AppCompatActivity activity;</span><br><span class="line">         Fragment fragment;</span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">public</span> <span class="title">Builder</span><span class="params">(AppCompatActivity activity)</span> </span>&#123;</span><br><span class="line">             <span class="keyword">this</span>.activity = activity;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">public</span> <span class="title">Builder</span><span class="params">(Fragment fragment)</span> </span>&#123;</span><br><span class="line">             <span class="keyword">this</span>.fragment = fragment;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">public</span> Builder <span class="title">setTitle</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">             <span class="keyword">this</span>.title = title;</span><br><span class="line">             <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">public</span> Builder <span class="title">setContent</span><span class="params">(String content)</span> </span>&#123;</span><br><span class="line">             <span class="keyword">this</span>.content = content;</span><br><span class="line">             <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">public</span> Builder <span class="title">setCancelable</span><span class="params">(<span class="keyword">boolean</span> cancelable)</span> </span>&#123;</span><br><span class="line">             <span class="keyword">this</span>.isCancelable = cancelable;</span><br><span class="line">             <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">public</span> Builder <span class="title">setConfirmText</span><span class="params">(String confirmText)</span> </span>&#123;</span><br><span class="line">             <span class="keyword">this</span>.confirmText = confirmText;</span><br><span class="line">             <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">public</span> Builder <span class="title">setCancelText</span><span class="params">(String cancelText)</span> </span>&#123;</span><br><span class="line">             <span class="keyword">this</span>.cancelText = cancelText;</span><br><span class="line">             <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">public</span> Builder <span class="title">setPositiveListener</span><span class="params">(DialogInterface.OnClickListener positiveListener)</span> </span>&#123;</span><br><span class="line">             <span class="keyword">this</span>.positiveListener = positiveListener;</span><br><span class="line">             <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">public</span> Builder <span class="title">setNegativeListener</span><span class="params">(DialogInterface.OnClickListener negativeListener)</span> </span>&#123;</span><br><span class="line">             <span class="keyword">this</span>.negativeListener = negativeListener;</span><br><span class="line">             <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="function"><span class="keyword">public</span> CommonDialog <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">             <span class="keyword">if</span> (activity != <span class="keyword">null</span>) &#123;</span><br><span class="line">                 <span class="keyword">return</span> <span class="keyword">new</span> CommonDialog(activity, title, content, confirmText, cancelText, isCancelable, positiveListener, negativeListener);</span><br><span class="line">             &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                 <span class="keyword">return</span> <span class="keyword">new</span> CommonDialog(fragment, title, content, confirmText, cancelText, isCancelable, positiveListener, negativeListener);</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h1 id="示例-DialogTool工具类的封装"><a href="#示例-DialogTool工具类的封装" class="headerlink" title="示例 - DialogTool工具类的封装"></a>示例 - DialogTool工具类的封装</h1><blockquote>
<p>知识点<br>1.静态内部类单例模式的应用。<br>2.Fragment初始化的方式(利用set、getArguments方法)。<br>3.如何为Fragment添加接口。<br>4.当屏幕重构时，利用findFragmentByTag找回原来的引用。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DialogTool</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String DIALOG_TAG = <span class="string">"DialogToolFragment"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 单例模式初始化工具</span><br><span class="line">     */</span></span><br><span class="line">    DialogToolFragment dialog;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Holder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> DialogTool INSTANCE = <span class="keyword">new</span> DialogTool();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    DialogTool() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DialogTool <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Holder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showDialog</span><span class="params">(AppCompatActivity context, String title, String msg, <span class="keyword">final</span> DialogInterface.OnClickListener positiveListener, DialogInterface.OnClickListener negativeListener)</span> </span>&#123;</span><br><span class="line">        dialog = DialogToolFragment.newInstance(title, msg).setPositiveListener(positiveListener).setNegativeListener(negativeListener);</span><br><span class="line">        dialog.setCancelable(<span class="keyword">false</span>); <span class="comment">//设置点击对话框外部不能取消对话框</span></span><br><span class="line">        dialog.setRetainInstance(<span class="keyword">false</span>);<span class="comment">//Fragment忽略屏幕重建，界面发生变化时，是否重新构建界面 true则构建。</span></span><br><span class="line">        dialog.show(context.getSupportFragmentManager(), DIALOG_TAG);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 当需要重新构建屏幕的时候调用该方法</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> context</span><br><span class="line">     * <span class="doctag">@param</span> title</span><br><span class="line">     * <span class="doctag">@param</span> msg</span><br><span class="line">     * <span class="doctag">@param</span> positiveListener</span><br><span class="line">     * <span class="doctag">@param</span> negativeListener</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRetainBundle</span><span class="params">(FragmentActivity context, String title, String msg, DialogInterface.OnClickListener positiveListener, DialogInterface.OnClickListener negativeListener)</span> </span>&#123;</span><br><span class="line">        dialog = (DialogToolFragment) context.getSupportFragmentManager().findFragmentByTag(DIALOG_TAG);<span class="comment">//找到重构前的fragment</span></span><br><span class="line">        dialog.setTitle(title);</span><br><span class="line">        dialog.setMsg(msg);</span><br><span class="line">        dialog.setNegativeListener(negativeListener);</span><br><span class="line">        dialog.setPositiveListener(positiveListener);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 必须设置为static类，否则报错</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DialogToolFragment</span> <span class="keyword">extends</span> <span class="title">DialogFragment</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> String TITLE = <span class="string">"TITLE"</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> String MSG = <span class="string">"MSG"</span>;</span><br><span class="line">        String title;</span><br><span class="line">        String msg;</span><br><span class="line">        DialogInterface.OnClickListener positiveListener;</span><br><span class="line">        DialogInterface.OnClickListener negativeListener;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">DialogToolFragment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 官方建议Fragment使用newInstance的方式进行初始化</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DialogToolFragment <span class="title">newInstance</span><span class="params">(String title, String msg)</span> </span>&#123;</span><br><span class="line">            DialogToolFragment fragment = <span class="keyword">new</span> DialogToolFragment();</span><br><span class="line">            Bundle bundle = <span class="keyword">new</span> Bundle();</span><br><span class="line">            bundle.putString(TITLE, title);</span><br><span class="line">            bundle.putString(MSG, msg);</span><br><span class="line">            fragment.setArguments(bundle);</span><br><span class="line">            <span class="keyword">return</span> fragment;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//为Fragment定义接口，设置相关的监听器。</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> DialogToolFragment <span class="title">setPositiveListener</span><span class="params">(DialogInterface.OnClickListener positiveListener)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.positiveListener = positiveListener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> DialogToolFragment <span class="title">setNegativeListener</span><span class="params">(DialogInterface.OnClickListener negativeListener)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.negativeListener = negativeListener;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@NonNull</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Dialog <span class="title">onCreateDialog</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">            Bundle bundle = getArguments();</span><br><span class="line">            title = bundle.getString(TITLE);</span><br><span class="line">            msg = bundle.getString(MSG);</span><br><span class="line">            AlertDialog.Builder builder = <span class="keyword">new</span> AlertDialog.Builder(getActivity());</span><br><span class="line"><span class="comment">//            builder.setIcon(R.mipmap.ic_launcher);</span></span><br><span class="line">            builder.setTitle(title);</span><br><span class="line">            builder.setMessage(msg);</span><br><span class="line"></span><br><span class="line">            builder.setPositiveButton(<span class="string">"确定"</span>, positiveListener);</span><br><span class="line">            builder.setNegativeButton(<span class="string">"取消"</span>, negativeListener);</span><br><span class="line">            <span class="keyword">return</span> builder.create();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTitle</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.title = title;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMsg</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.msg = msg;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


            <!-- Tags -->
            


<div class="tags">
    <a href="/tags/DialogFragment笔记/">DialogFragment笔记</a>
</div>



            <!-- Comments -->
            <div>
                




            </div>
        </div><!-- end content -->
    </section>
</section><!-- end main -->

<!-- After footer scripts -->

<!-- jQuery -->
<script src="/js/jquery.js"></script>

<!-- Custom Code -->
<script src="/js/main.js"></script>

<!-- Gallery -->
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->


</body>

</html>