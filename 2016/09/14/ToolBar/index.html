<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />

    <!--Description-->
    
        <meta name="description" content="Build a better app.">
    

    <!--Author-->
    
        <meta name="author" content="TanJunDang">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Toolbar笔记"/>
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="TanJunDang"/>

    <!--Page Cover-->
    
        <meta property="og:image" content="undefined"/>
    

    <!-- Title -->
    
    <title>Toolbar笔记 - TanJunDang</title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/main.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


    <!--Favicon-->
    

</head>

<body>

<!-- Menu -->
<!-- Navigation -->
<header>
    <div class="logo">
        <a href="/">TanJunDang</a>
    </div><!-- end logo -->

    <div id="menu_icon"></div>
    <nav>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives">Archives</a>
            </li>
            
        </ul>
    </nav><!-- end navigation menu -->

    <div class="footer clearfix">
        <ul class="social clearfix">
            
            
                <li><a href="https://www.facebook.com/" class="fb" target="_blank" data-title="Facebook"></a></li>
            
            
                <li><a href="https://www.behance.net/" class="behance" target="_blank" data-title="Behance"></a></li>
            
            
                <li><a href="https://plus.google.com/+Pixelhint/posts" class="google" target="_blank" data-title="Google+"></a></li>
            
            
                <li><a href="https://dribbble.com/pixelhint" class="dribble" target="_blank" data-title="Dribble"></a></li>
            
            
            
            
        </ul><!-- end social -->

        <div class="rights">
            <p>Copyright © 2014 magnetic.</p>
            <p>Template by <a href="http://pixelhint.com/magnetic-free-html5-responsive-photography-website-template/">Pixelhint.com</a></p>
            <p>Hexo Theme by <a href="http://www.codeblocq.com/">Jonathan K.</a></p>
        </div><!-- end rights -->
    </div ><!-- end footer -->
</header><!-- end header -->


<!-- Main Content -->
<section class="main clearfix">

    <section class="top" style="background: url('http://placehold.it/1300x500');">
        <div class="wrapper content_header clearfix">
            

<div class="work_nav">

    <ul class="btn clearfix">
        
        <li><a href="/2016/10/09/ViewPager/" class="previous" data-title="ViewPager笔记"></a></li>
        
        <li><a href="/" class="grid" data-title="Portfolio"></a></li>
        
        <li><a href="/2016/09/07/Preference/" class="next" data-title="Preference的使用"></a></li>
        
    </ul>

</div><!-- end work_nav -->
            <h1 class="title">Toolbar笔记</h1>
        </div>
    </section><!-- end top -->

    <section class="wrapper">
        <div class="content">

            <!-- Gallery -->
            

            <!-- Content -->
            <h1 id="ActionBar基本知识"><a href="#ActionBar基本知识" class="headerlink" title="ActionBar基本知识"></a>ActionBar基本知识</h1><blockquote>
<p>1.Android 3.0(API level 11)版本之后，所有使用默认主题的Activity都包含有Actionbar。<br>2.如果需要支持Android 2.0(API level 7)版本，需要修改mainfest中的minSdkVersion版本。<br>3.如果需要自定义ActionBar，则先设置Activity的Theme为NoActionBar(需要设置name/parent)，然后通过添加ToolBar来实现。<br>4.values、values-xx的理解。</p>
<ul>
<li>values表示所有API使用该文件。</li>
<li>values-xx表示XXAPI起，使用该文件。</li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="取消ToolBar左边距"><a href="#取消ToolBar左边距" class="headerlink" title="取消ToolBar左边距"></a>取消ToolBar左边距</h2><blockquote>
<p>app:contentInsetStart=”0dp”</p>
</blockquote>
<h2 id="反射获取私有成员"><a href="#反射获取私有成员" class="headerlink" title="反射获取私有成员"></a>反射获取私有成员</h2><blockquote>
<p>示例<br>获取ToolBar里的返回按钮</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">        Class clazz = Class.forName(<span class="string">"android.support.v7.widget.Toolbar"</span>);</span><br><span class="line">        Field field = clazz.getDeclaredField(<span class="string">"mNavButtonView"</span>);</span><br><span class="line">        <span class="comment">// 设置允许获取私有变量</span></span><br><span class="line">        field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// get方法需要传入获取的数据源</span></span><br><span class="line">        ImageView imageView = (ImageView) field.get(titleBinding.toolbar);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://blog.csdn.net/sun__qi/article/details/52623080" target="_blank" rel="external">反射参考</a></p>
<h2 id="示例-创建一个APP-SupportActionBar"><a href="#示例-创建一个APP-SupportActionBar" class="headerlink" title="示例 - 创建一个APP SupportActionBar"></a>示例 - 创建一个APP SupportActionBar</h2><blockquote>
<p>步骤<br>1.继承AppCompatActivity。<br>2.XML布局中添加ToolBar控件。<br>3.在Mainfest文件设置Activity的theme属性为NoActionBar。<br>4.在Activity中调用setSupportActionBar方法设置ToolBar。</p>
</blockquote>
<h3 id="步骤1"><a href="#步骤1" class="headerlink" title="步骤1"></a>步骤1</h3><blockquote>
<p>继承AppCompatActivity</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MActionBarActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤2"><a href="#步骤2" class="headerlink" title="步骤2"></a>步骤2</h3><blockquote>
<p>xml添加ToolBar</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span></span><br><span class="line"> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span><br><span class="line">    <span class="attr">android:background</span>=<span class="string">"@color/white"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span><br><span class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></span><br><span class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span><br><span class="line">        <span class="attr">android:background</span>=<span class="string">"@color/blue"</span></span><br><span class="line">        <span class="attr">android:elevation</span>=<span class="string">"8dp"</span>&gt;</span><span class="tag">&lt;/<span class="name">android.support.v7.widget.Toolbar</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="步骤3"><a href="#步骤3" class="headerlink" title="步骤3"></a>步骤3</h3><blockquote>
<p>设置Activity的Theme属性</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//Mainfest文件</span><br><span class="line"><span class="tag">&lt;<span class="name">activity</span></span><br><span class="line">    <span class="attr">android:name</span>=<span class="string">".test.actionbar.MActionBarActivity"</span></span><br><span class="line">    <span class="attr">android:theme</span>=<span class="string">"@style/Theme.AppCompat.Light.NoActionBar"</span>&gt;</span><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    //style文件</span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"Theme.AppCompat.Light.NoActionBar"</span>&gt;</span><span class="xml"></span><br><span class="line">    /* <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"windowActionBar"</span>&gt;</span>false<span class="tag">&lt;/<span class="name">item</span>&gt;</span>//关闭默认的actionbar</span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"windowNoTitle"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span>//关闭默认的Title</span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:statusBarColor"</span>&gt;</span>@android:color/holo_red_dark<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowDrawsSystemBarBackgrounds"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span> */</span><br><span class="line">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a href="/2016/01/01/Style/">Style的基础知识</a></p>
<h3 id="步骤四"><a href="#步骤四" class="headerlink" title="步骤四"></a>步骤四</h3><blockquote>
<p>设置ActionBar</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MActionBarActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Toolbar toolbar;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_maction_bar);</span><br><span class="line">        toolbar = (Toolbar) findViewById(R.id.toolbar);</span><br><span class="line">        toolbar.setTitleTextColor(Color.WHITE);</span><br><span class="line">        setSupportActionBar(toolbar);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>效果</p>
</blockquote>
<p><img src="http://imglf0.nosdn.127.net/img/ZFRpZXBrMUVQR0J6NExJMG1TVGg3RnVqQy9yTlZ5Z3dRQS9vanZXcHdPWGg5WG1FN21NRG53PT0.gif" alt=""></p>
<h1 id="示例-ActionBar添加按钮"><a href="#示例-ActionBar添加按钮" class="headerlink" title="示例 - ActionBar添加按钮"></a>示例 - ActionBar添加按钮</h1><blockquote>
<p>步骤<br>1.res/menu目录下创建一个xml布局文件。<br>2.定义Menu的Item。<br>3.在Activity中重写onCreateOptionsMenu方法，加载上述布局文件。<br>4.在Activity中重写onOptionsItemSelected方法，为按钮添加监听事件。</p>
</blockquote>
<h2 id="定义Menu"><a href="#定义Menu" class="headerlink" title="定义Menu"></a>定义Menu</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span><br><span class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/action_send"</span></span><br><span class="line">        <span class="attr">android:icon</span>=<span class="string">"@drawable/ic_menu_send"</span></span><br><span class="line">        <span class="attr">android:title</span>=<span class="string">"发送"</span></span><br><span class="line">        <span class="attr">app:showAsAction</span>=<span class="string">"always"</span>&gt;</span><span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span><br><span class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/action_setting"</span></span><br><span class="line">        <span class="attr">android:icon</span>=<span class="string">"@drawable/ic_menu_camera"</span></span><br><span class="line">        <span class="attr">android:title</span>=<span class="string">"设置"</span></span><br><span class="line">        <span class="attr">app:showAsAction</span>=<span class="string">"never"</span>&gt;</span><span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>效果如下</p>
</blockquote>
<p><img src="http://imglf1.nosdn.127.net/img/ZFRpZXBrMUVQR0NhYk9WSnpiLzVGbERYWWE5akVHcmgxZjU1emhkME03ekh6a1FTcURQK1lBPT0.png?imageView&amp;thumbnail=300x0&amp;quality=96&amp;stripmeta=0&amp;type=jpg" alt=""></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote>
<p>1.android:showAsAction与app:showAsAction的区别</p>
<ul>
<li>Android2.0下android:showAsAction属性无效，所以通常使用app:showAsAction</li>
</ul>
<p>2.showAsAction属性的灵活使用，见下图。</p>
</blockquote>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>app:showAsAction</td>
<td>控制菜单Item的显示</td>
<td>always - 一直显示在ActionBar上 <br> ifRoom - 如果有空间，才显示在ActionBar上，一般用于SearchView <br> nerver - 将菜单项设置成为默认菜单的子菜单项，并且设置的icon无效 <br> withText - 图标跟文本一起显示 <br> collapseActionView - 当前MenuItem不可遮挡其他MenuItem</td>
</tr>
</tbody>
</table>
<blockquote>
<p>app:showAsAction=”nerver”的效果</p>
</blockquote>
<p><img src="http://imglf1.nosdn.127.net/img/ZFRpZXBrMUVQR0NhYk9WSnpiLzVGcG5tR0pzN1MzeU1Qbk56ZWF0VjBrMkRyRWpBQVdlT2VRPT0.gif" alt=""></p>
<blockquote>
<p>app:showAsAction=”ifRoom|collapseActionView”的效果</p>
</blockquote>
<p><img src="http://imglf1.nosdn.127.net/img/ZFRpZXBrMUVQR0NSdEJXU29KR3JzbFVsNVZHcHkzdExLZkJ1L2ZGT0dmWm9Lc1BNNWplQjFRPT0.gif" alt=""></p>
<p><a href="https://developer.android.com/training/appbar/up-action.html#enable-up" target="_blank" rel="external">官方教程</a></p>
<h1 id="示例-ActionBar设置向上按钮"><a href="#示例-ActionBar设置向上按钮" class="headerlink" title="示例 - ActionBar设置向上按钮"></a>示例 - ActionBar设置向上按钮</h1><blockquote>
<p>ActionBar可以添加返回上一个页面的按钮</p>
<p>步骤<br>1.在mainfest中为当前Activity添加返回的页面。<br>2.调用setDisplayHomeAsUpEnabled方法激活向上返回按钮。</p>
</blockquote>
<h2 id="设置返回页面"><a href="#设置返回页面" class="headerlink" title="设置返回页面"></a>设置返回页面</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span> <span class="attr">...</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">activity</span></span><br><span class="line">        <span class="attr">android:name</span>=<span class="string">"com.example.myfirstapp.MainActivity"</span> <span class="attr">...</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- A child of the main activity --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">activity</span></span><br><span class="line">        <span class="attr">android:name</span>=<span class="string">"com.example.myfirstapp.MyChildActivity"</span></span><br><span class="line">        <span class="attr">android:label</span>=<span class="string">"@string/title_activity_child"</span></span><br><span class="line">        <span class="attr">android:parentActivityName</span>=<span class="string">"com.example.myfirstapp.MainActivity"</span> &gt;</span></span><br><span class="line">        /*4.0以上调用parentActivityName方法来设置返回的Activity，4.0以下通过meta来设置*/</span><br><span class="line">        <span class="comment">&lt;!-- Parent activity meta-data to support 4.0 and lower --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta-data</span></span><br><span class="line">            <span class="attr">android:name</span>=<span class="string">"android.support.PARENT_ACTIVITY"</span></span><br><span class="line">            <span class="attr">android:value</span>=<span class="string">"com.example.myfirstapp.MainActivity"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="在Activity中激活向上按钮"><a href="#在Activity中激活向上按钮" class="headerlink" title="在Activity中激活向上按钮"></a>在Activity中激活向上按钮</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">getSupportActionBar().setDisplayHomeAsUpEnabled(<span class="keyword">true</span>); <span class="comment">//显示向上按钮</span></span><br><span class="line">getSupportActionBar().setHomeAsUpIndicator(R.drawable.ic_menu_gallery);<span class="comment">//修改向上按钮的图标</span></span><br></pre></td></tr></table></figure>
<h1 id="示例-ActionBar添加搜索栏"><a href="#示例-ActionBar添加搜索栏" class="headerlink" title="示例 - ActionBar添加搜索栏"></a>示例 - ActionBar添加搜索栏</h1><blockquote>
<p>点击MenuItem显示搜索栏</p>
</blockquote>
<p><img src="http://imglf2.nosdn.127.net/img/ZFRpZXBrMUVQR0NqZG53R2lQem1GSVZJR0QwSkIveVN5U2NQY1JYQzJ6VncwQ2EyUDhqd1NBPT0.gif" alt=""></p>
<blockquote>
<p>步骤<br>1.在xml定义MenuItem，设置actionViewClass、showAsAction属性。<br>2.在Activity中重写onCreateOptionMenu方法。</p>
<ul>
<li>加载menu的xml文件。</li>
<li>通过Menu的findItem方法来找到xml中的MenuItem。</li>
<li>通过MenuItemCompat的getActionView方法来获取actionViewClass指定的View</li>
</ul>
</blockquote>
<h2 id="步骤一"><a href="#步骤一" class="headerlink" title="步骤一"></a>步骤一</h2><blockquote>
<p>在Menu布局中设置actionViewClass、showAsAction方法</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span><br><span class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/action_send"</span></span><br><span class="line">        <span class="attr">android:icon</span>=<span class="string">"@drawable/ic_menu_send"</span></span><br><span class="line">        <span class="attr">android:title</span>=<span class="string">"发送"</span></span><br><span class="line">        <span class="attr">app:actionViewClass</span>=<span class="string">"android.support.v7.widget.SearchView"</span></span><br><span class="line">        <span class="attr">app:showAsAction</span>=<span class="string">"ifRoom"</span>&gt;</span><span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="步骤二"><a href="#步骤二" class="headerlink" title="步骤二"></a>步骤二</h2><blockquote>
<p>重写onCreateOptionMenu的方法</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>&#123;</span><br><span class="line">    MenuInflater inflater = getMenuInflater();</span><br><span class="line">    inflater.inflate(R.menu.actionbar_menu, menu);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过调用Menu的findItem方法来获取Item</span></span><br><span class="line">    MenuItem searchItem = menu.findItem(R.id.action_send);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过MenuItemCompat的getActionView方法来获取View。</span></span><br><span class="line">    <span class="comment">//可通过MenuItemCompat的OnActionExpandListener方法来设置展开收缩监听器。</span></span><br><span class="line">    SearchView searchView = (SearchView) MenuItemCompat.getActionView(searchItem);</span><br><span class="line">    searchView.setOnQueryTextListener(<span class="keyword">new</span> SearchView.OnQueryTextListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onQueryTextSubmit</span><span class="params">(String query)</span> </span>&#123;</span><br><span class="line">            Functions.toast(query);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onQueryTextChange</span><span class="params">(String newText)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onCreateOptionsMenu(menu);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


            <!-- Tags -->
            


<div class="tags">
    <a href="/tags/Toolbar笔记/">Toolbar笔记</a>
</div>



            <!-- Comments -->
            <div>
                




            </div>
        </div><!-- end content -->
    </section>
</section><!-- end main -->

<!-- After footer scripts -->

<!-- jQuery -->
<script src="/js/jquery.js"></script>

<!-- Custom Code -->
<script src="/js/main.js"></script>

<!-- Gallery -->
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->


</body>

</html>